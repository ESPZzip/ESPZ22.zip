<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Marketplace - Dominus Prefius</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f2f2f2; }
    header { background: #333; color: white; padding: 10px; display: flex; justify-content: space-between; }
    .section { padding: 20px; }
    .item-card { display: inline-block; border: 1px solid #ccc; padding: 15px; margin: 10px; background: white; border-radius: 10px; text-align: center; }
    .item-card img { border-radius: 8px; }
  </style>
</head>
<body>
  <header>
    <div id="playerName">Invitado</div>
    <div>Robux: <span id="playerRobux">100</span></div>
  </header>

  <main>
    <div id="marketplace" class="section">
      <h2>Marketplace</h2>
      <div id="marketContainer"></div>
    </div>

    <div id="inventory" class="section">
      <h2>Inventario</h2>
      <div id="inventoryContainer"></div>
    </div>
  </main>

  <script>
    // Datos iniciales
    let currentUser = "Invitado";
    let users = JSON.parse(localStorage.getItem("users") || "{}");
    if(!users[currentUser]) users[currentUser] = { robux: 100, inventory: [] };
    localStorage.setItem("users", JSON.stringify(users));

    let items = [
      {
        id: "dominus_prefius",
        name: "Dominus Prefius",
        img: "https://tr.rbxcdn.com/180DAY-75378372edcd1f03ab46459b4e15038a/420/420/Hat/Webp/noFilter",
        price: 45,
        stock: 3
      }
    ];

    function renderMarketplace(){
      const c=document.getElementById("marketContainer");
      c.innerHTML="";
      items.forEach(it=>{
        const d=document.createElement("div");
        d.className="item-card";
        d.innerHTML=`
          <img src="${it.img}" width="120"><br>
          <h3>${it.name}</h3>
          <p><b>${it.price}</b> Robux</p>
          <p>Stock: ${it.stock}</p>
          <button onclick="buyItem('${it.id}')">Comprar</button>
        `;
        c.appendChild(d);
      });
    }

    function renderInventory(){
      const c=document.getElementById("inventoryContainer");
      c.innerHTML="";
      let inv=users[currentUser].inventory;
      if(inv.length===0){ c.innerHTML="<p>No tienes ítems.</p>"; return; }
      inv.forEach(id=>{
        const item=items.find(i=>i.id===id);
        if(item){
          const d=document.createElement("div");
          d.className="item-card";
          d.innerHTML=`<img src="${item.img}" width="100"><h4>${item.name}</h4>`;
          c.appendChild(d);
        }
      });
    }

    function buyItem(id){
      let item=items.find(i=>i.id===id);
      if(!item||item.stock<=0){ alert("Este ítem ya no está disponible."); return; }
      if(users[currentUser].robux<item.price){ alert("No tienes suficientes Robux."); return; }
      // Procesar compra
      users[currentUser].robux-=item.price;
      users[currentUser].inventory.push(item.id);
      item.stock--;
      localStorage.setItem("users",JSON.stringify(users));
      document.getElementById("playerRobux").textContent=users[currentUser].robux;
      alert(`Has comprado ${item.name}!`);
      renderMarketplace();
      renderInventory();
    }

    // Inicialización
    window.onload=()=>{
      renderMarketplace();
      renderInventory();
      document.getElementById("playerRobux").textContent=users[currentUser].robux;
    };
  </script>
</body>
</html>
